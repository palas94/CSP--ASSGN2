<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <title>
            Find MP
        </title>
        
        <script type="text/javascript" src="http://www.google.com/jsapi"></script>
        <script type="text/javascript">
            google.load('visualization', '1.1', {packages: ['table', 'corechart', 'controls']});
            </script>
        <script type="text/javascript">
            var visualization;
            
            function drawVisualization() {
                var query = new google.visualization.Query(
                                                           'https://docs.google.com/spreadsheet/tq?range=A1%3AAB553&key=0AsVRW51CMwa-dDBiSmhVUHphRl9oYnJmdEcxOVNVZHc&gid=0&headers=-1');
                query.setQuery('select A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,Q,R,S,T,U,V,W,X  ');
                // Send the query with a callback function.
                query.send(handleQueryResponse);
            }
            
            function handleQueryResponse(response) {
                if (response.isError()) {
                    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                    return;
                }
                var data = response.getDataTable();
               
                var countryPicker = new google.visualization.ControlWrapper({
                                                                            'controlType': 'CategoryFilter',
                                                                            'containerId': 'control1',
                                                                            'options': {
                                                                            'filterColumnLabel': 'State',
                                                                            'ui': {
                                                                            'labelStacking': 'vertical',
                                                                            'allowTyping': false,
                                                                            'allowMultiple': true
                                                                            }
                                                                            }
                                                                            });
                
                var regionPicker = new google.visualization.ControlWrapper({
                                                                           'controlType': 'CategoryFilter',
                                                                           'containerId': 'control2',
                                                                           'options': {
                                                                           'filterColumnLabel': 'Political party',
                                                                           'ui': {
                                                                           'labelStacking': 'vertical',
                                                                           'allowTyping': false,
                                                                           'allowMultiple': true
                                                                           }
                                                                           }
                                                                           });
                
                var cityPicker = new google.visualization.ControlWrapper({
                                                                         'controlType': 'CategoryFilter',
                                                                         'containerId': 'control3',
                                                                         'options': {
                                                                         'filterColumnLabel': 'MP name',
                                                                         'ui': {
                                                                         'labelStacking': 'vertical',
                                                                         'allowTyping': false,
                                                                         'allowMultiple': true
                                                                         }
                                                                         }
                                                                         });
                
                var table = new google.visualization.ChartWrapper({
                                                                  'chartType': 'Table',
                                                                  'containerId': 'chart1',
                                                                  'options': {
                                                                  'width': '1170px'
                                                                  }
                                                                  });
                
                new google.visualization.Dashboard(document.getElementById('dashboard')).
                bind(countryPicker, regionPicker).
                bind(regionPicker, cityPicker).
                bind(cityPicker, table).
                draw(data);
                
            }
            
            
            google.setOnLoadCallback(drawVisualization);
            </script>
    </head>
    <body style="font-family: sans-serif;border: 0 none;">
        <div id="dashboard">
            <table>
                <tr style='vertical-align: top'>
                    <td style='width: 150px; font-size: 0.9em;'>
					<br><br><br><br><br><br><br>
                        <div  id="control1"></div>
						<br><br>
                        <div id="control2"></div>
						<br><br>
                        <div  id="control3"></div>
                    </td>
                    <td >
					<br><br><br><br><br>
                        <div style="float: left;border:3px inset black" id="chart1"></div>
                    </td>
                </tr>
            </table>
        </div>
    </body>
</html>
â€‹